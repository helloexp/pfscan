#!/bin/bash

CMDNAME=`basename $0`
OUTFILE=$2_http_dirscan_$1.txt

DIRLIST="\
1\
 2\
 3\
 4\
 5\
 6\
 7\
 8\
 9\
 10\
 .bak\
 .cobalt\
 .ssh\
 _backup\
 _bsLib\
 _derived\
 _errors\
 _fpclass\
 _mem_bin\
 _notes\
 _objects\
 _old\
 _pages\
 _passwords\
 _private\
 _ScriptLibrary\
 _scripts\
 _sharedtemplates\
 _tests\
 _themes\
 _vti_bin\
 _vti_bot\
 _vti_log\
 _vti_pvt\
 _vti_shm\
 _vti_txt\
 ~1\
 ~admin\
 ~log\
 ~root\
 ~stats\
 ~webstats\
 ~wsdocs\
 4images\
 99articles\
 a\
 aardvarktopsites\
 about\
 acal\
 acceso\
 access\
 accesswatch\
 acciones\
 account\
 accounting\
 acid\
 activex\
 actualanalyzer\
 addons\
 adm\
 admbook\
 admcgi\
 admentor\
 admin\
 Admin\
 admin.back\
 admin_\
 Admin_files\
 admin-bak\
 Administration\
 administrator\
 admin-old\
 adminuser\
 AdminWeb\
 admisapi\
 ads\
 adserver\
 AdvWebAdmin\
 agenda\
 Agent\
 agentes\
 Agents\
 agora\
 Album\
 AlbumArt_\
 albums\
 amazon\
 amember\
 amserver\
 analog\
 angeline\
 anthill\
 apache\
 app\
 applets\
 application\
 applications\
 apps\
 ar\
 archive\
 archives\
 articles\
 asp\
 aspnet\
 aspx\
 asteridex\
 atc\
 auction\
 auktion\
 auth\
 authadmin\
 aw\
 awstats\
 awstats/cgi-bin\
 awstats-cgi\
 awstatstotals\
 axis2\
 ayuda\
 b\
 b2-include\
 back\
 backend\
 backup\
 backups\
 bak\
 balancer\
 banca\
 banco\
 bank\
 banner\
 banner01\
 bannerexchange\
 banners\
 base\
 basilix\
 batch\
 bb-dnbd\
 bbs\
 bbv\
 bdata\
 bdatos\
 beta\
 billpay\
 bin\
 bitweaver\
 BizTalkServerDocs\
 BizTalkServerRepository\
 BizTalkTracking\
 blob\
 blog\
 blogs\
 bmachine\
 boadmin\
 board\
 boastmachine\
 boonex\
 boot\
 Boutiques\
 btauxdir\
 bug\
 bugs\
 bugzilla\
 bugzilla3\
 business\
 buy\
 buynow\
 c\
 cache-stats\
 cacti\
 caja\
 cal\
 calendar\
 calendarexpress\
 calendarix\
 candypress\
 card\
 cards\
 cart\
 cash\
 caspsamp\
 catalog\
 cbi-bin\
 ccard\
 ccards\
 cd\
 cd-cgi\
 cdrom\
 ce_html\
 centreon\
 cerberus\
 cerberus-gui\
 cert\
 certificado\
 certificate\
 cfappman\
 cfdocs\
 cfide\
 cgi\
 cgi-auth\
 cgi-bim\
 cgibin\
 cgi-bin\
 cgi-bin/dada\
 cgi-bin/eboard40/\
 cgi-bin/mt\
 cgi-bin/openwebmail\
 cgi-bin/sysinfo\
 cgi-bin/twiki\
 cgi-bin/viewvc.cgi\
 cgi-bin2\
 cgi-csc\
 cgi-isapi\
 cgilib\
 cgi-lib\
 cgi-local\
 cgi-public\
 cgis\
 cgiscripts\
 cgi-scripts\
 cgi-shl\
 cgi-shop\
 cgi-sys\
 cgi-weddico \
 cgiwin\
 cgi-win\
 chat\
 chora\
 clan\
 clan-nic\
 claroline\
 class\
 classes\
 classified\
 classifieds\
 client\
 cliente\
 clientes\
 cm\
 cmp\
 cms\
 cms400\
 cms400.net\
 cmsample\
 cmsmadesimple\
 cmsms\
 cobalt-images\
 code\
 comersus\
 comments\
 common\
 communicator\
 community\
 company\
 compra\
 compras\
 compressed\
 conecta\
 conf\
 config\
 connect\
 console\
 contenido\
 content\
 controlpanel\
 coppermine\
 core\
 corp\
 Corporate\
 correo\
 counter\
 cpg\
 credit\
 crm\
 cron\
 crons\
 crypto\
 CS\
 csr\
 css\
 cuenta\
 cuentas\
 currency\
 currently\
 customers\
 cute\
 cutenews\
 CVS\
 cvstrac\
 cvsweb\
 cybercash\
 d\
 daloradius\
 dana/fb/smb\
 darkportal\
 dat\
 data\
 database\
 databases\
 datafiles\
 dato\
 datos\
 db\
 DB4Web\
 dbase\
 dcforum\
 ddreport\
 ddrint\
 de\
 demo\
 demoauct\
 demomall\
 demos\
 design\
 dev\
 devel\
 development\
 DigitalScribe\
 dir\
 directory\
 directorymanager\
 discuz\
 dl\
 dll\
 dm\
 DMR\
 dms\
 dms0\
 dmsdump\
 doc\
 doc1\
 doceboCms\
 doceboCore\
 doceboKms\
 doceboLms\
 doc-html\
 docs\
 docs1\
 DocuColor\
 document\
 documentation\
 documents\
 docushare\
 dokeos\
 doku\
 dokuwiki\
 dolibarr\
 dolphin\
 dotcms\
 dotnetnuke\
 dotProject\
 down\
 download\
 downloads\
 drupal\
 dsdn\
 dspam\
 dump\
 durep\
 e\
 e107\
 eAccelerator\
 easy_cms_module\
 easydownload\
 easylog\
 ecard\
 ecartis\
 ee\
 eFiction\
 eforum\
 eggblog\
 egs\
 ejemplo\
 ejemplos\
 elog\
 email\
 emailclass\
 eManager\
 employees\
 empoyees\
 empris\
 en\
 en-US\
 envia\
 enviamail\
 error\
 errors\
 es\
 estmt\
 esupport\
 etc\
 etomite\
 events\
 example\
 examples\
 exc\
 excel\
 exchange\
 exchweb\
 exe\
 exec\
 exhibit\
 exhibitengine\
 exodesk\
 exoops\
 exophpdesk\
 exponent\
 export\
 extension\
 external\
 EZPhotoSales\
 f\
 fanfiction\
 faq\
 fbsd\
 fcgi-bin\
 fckeditor\
 feeds\
 feedsplitter\
 file\
 filemanager\
 filemgr\
 files\
 firestats\
 flatnuke\
 flexcms\
 flexcube@\
 flexcubeat\
 flyspeck\
 flyspray\
 foldoc\
 form\
 forms\
 formsmgr\
 form-totaller\
 forum\
 forum/forum\
 forums\
 forums/forum\
 foto\
 fotos\
 fpadmin\
 fpdb\
 fpsample\
 fr\
 frameset\
 framesets\
 ftp\
 ftproot\
 fusetalk/blog\
 fusetalk/forum\
 fusion\
 fuzzylime\
 g\
 galleries\
 Gallery\
 ganglia\
 gb\
 gbook\
 gbs\
 gcards\
 geeklog\
 getid3\
 gf\
 gforge\
 gfx\
 global\
 gregarius\
 greymatter\
 grocery\
 guest\
 guestbook\
 guests\
 guppy\
 gust\
 GWextranet\
 GXApp\
 HB\
 HBTemplates\
 hc\
 hcl\
 help\
 helpcenter\
 helpcenterlive\
 helpdesk\
 hidden\
 hide\
 hit_tracker\
 hitmatic\
 hlstats\
 home\
 horde\
 hosting_controller\
 hostingcontroller\
 host-manager/html\
 howto\
 hr\
 ht\
 htbin\
 htdocs\
 html\
 hyperstat\
 ibank\
 ibill\
 IBMWebAS\
 ical\
 icalendar\
 icons\
 idea\
 idealbb\
 ideas\
 idm\
 iisadmin\
 iisprotect\
 iissamples\
 IlohaMail\
 image\
 imagenes\
 imagery\
 images\
 ImageVue\
 imap\
 imcws\
 img\
 imp\
 import\
 impreso\
 inc\
 include\
 includer\
 includes\
 incoming\
 info\
 information\
 ingo\
 ingresa\
 ingreso\
 Install\
 install\
 interchange\
 internal\
 intl\
 intranet\
 introbuilder\
 inventory\
 invision\
 invitado\
 ipb\
 isapi\
 ixmail\
 jackrabbit\
 japidoc\
 java\
 javascript\
 javasdk\
 javatest\
 jave\
 JBookIt\
 jcart\
 jdbc\
 jffnms\
 jinzora\
 jira\
 job\
 joomla\
 journal\
 jrun\
 js\
 jserv\
 jslib\
 jsp\
 jsp-examples\
 JSPWiki\
 jukebox\
 junk\
 kayako\
 keyserver\
 kiva\
 klan\
 labs\
 lampp\
 lcgi\
 ledger\
 ledgersmb\
 ledger-smb\
 legal\
 lib\
 libraries\
 library\
 libro\
 lifetype\
 limbo\
 limesurvey\
 links\
 linpha\
 linux\
 lists\
 lists/admin\
 live\
 livehelp\
 loader\
 local\
 log\
 logfile\
 logfiles\
 logg\
 logger\
 logging\
 login\
 logon\
 logrover\
 logs\
 lost+found\
 loudblog\
 maia\
 Mail\
 mail_log_files\
 mailguard\
 mailgust\
 maillist\
 mailman\
 mailroot\
 mailscanner\
 mailserver\
 mailwatch\
 main/inc/lib\
 makefile\
 mall_log_files\
 mambo\
 manage\
 manager\
 manager/html\
 mantis\
 manual\
 manual/images\
 manual/style\
 marketing\
 mdpro\
 mediawiki\
 member\
 members\
 mercuryboard\
 message\
 messaging\
 MessagingManager\
 metacart\
 mini\
 minibb\
 misc\
 mkstats\
 mnemo\
 modules/forum\
 modx\
 moinmoin\
 moodle\
 movimientos\
 mp3\
 mp3s\
 mqseries\
 mrbs\
 msql\
 Msword\
 mt\
 mvnforum\
 myaccount\
 mybb\
 myreview\
 mysql\
 mysql_admin\
 nag\
 ncadmin\
 nchelp\
 ncsample\
 netbasic\
 netcat\
 NetDynamic\
 NetDynamics\
 netmagstats\
 netoffice\
 netofficedwins\
 netscape\
 netshare\
 nettracker\
 new\
 News\
 newsfeeds\
 nextgeneration\
 nl\
 noahsclassifieds\
 NOCC\
 noticias\
 NSearch\
 nucleus\
 nuked-clan\
 nukedit\
 obj\
 objects\
 observer\
 ocs\
 odbc\
 oempro\
 offers\
 old\
 old_files\
 oldfiles\
 oneorzero\
 OnlineViewing\
 ooz\
 openads\
 openbb\
 openbiblio\
 opencart\
 openemr\
 opennms\
 opensso\
 openwebmail-cgi\
 openx\
 oprocmgr-service\
 oprocmgr-status\
 oracle\
 oradata\
 oramon\
 orangehrm\
 orangehrm2\
 order\
 orders\
 oreon\
 original\
 oscommerce\
 ossim\
 otrs\
 outgoing\
 OvCgi\
 owl\
 owners\
 pafiledb\
 pages\
 pajax\
 panews\
 passport\
 password\
 passwords\
 payment\
 payments\
 pblang\
 pccsmysqladm\
 PDG_Cart\
 perl\
 perl5\
 perl-status\
 personal\
 personal_pages\
 pforum\
 philboard\
 phorum\
 photo\
 photoalbum\
 photos\
 php\
 php_classes\
 phpAlbum\
 phpATM\
 phpauction\
 phpay\
 phpBB\
 phpBB2\
 phpblogger\
 php-blogger\
 phpclassifieds\
 phpcoin\
 phpdoc\
 PhpDocumentor\
 phpeasydownload\
 php-files\
 phpfm\
 phpform\
 phpformgenerator\
 phpGedView\
 phpicalendar\
 phpimageview\
 phpkit\
 phpldapadmin\
 phplist\
 phplistpro\
 phplive\
 phplivehelper\
 phpMyAdmin\
 phpmyagenda\
 phpMyConferences\
 phpmyfaq\
 phpnews\
 phpnuke\
 phppgadmin\
 phpPhotoAlbum\
 phpprojekt\
 phprojekt\
 phproxy\
 phpsane\
 phpSecurePages\
 phpslash\
 phpsupporttickets\
 phpsurveyor\
 phpSysInfo\
 phpu\
 phpupdate\
 phpwcms\
 phpwebadmin\
 phpwebgallery\
 phpwebsite\
 phpwebthings\
 phpwt\
 phpx\
 pipermail\
 piranha\
 piwigo\
 pixelpost\
 pla\
 pligg\
 plog\
 plogger\
 Plone\
 pls\
 pluck\
 plume\
 pma\
 pmos\
 pmwiki\
 podcast\
 podcasts\
 poll\
 pollphp\
 polls\
 portal\
 portalapp\
 poster\
 postgres\
 poxy\
 ppwb\
 prestashop\
 printers\
 priv\
 privado\
 private\
 prod\
 project\
 projectpier\
 projects\
 protected\
 prueba\
 pruebas\
 prv\
 psynch\
 ptnews\
 pub\
 pubcookie\
 public\
 public_html\
 publica\
 publicar\
 publico\
 publish\
 publisher\
 punbb\
 purchase\
 purchases\
 pw\
 pwa\
 random_banner\
 rc\
 rcblog\
 rdp\
 README\
 recordings\
 ref\
 register\
 registered\
 rem\
 Remote\
 report\
 reports\
 reseller\
 restricted\
 retail\
 reviews\
 ROADS\
 roller\
 root\
 roundcube\
 roundcubemail\
 rsrc\
 rth\
 runcms\
 sales\
 sample\
 samples\
 sane\
 save\
 sbbs\
 sblog\
 scan\
 schedule\
 scribe\
 script\
 scripts\
 search\
 search97\
 search-ui\
 secret\
 secure\
 secured\
 seditio\
 segue\
 seguecms\
 sell\
 serve\
 server_stats\
 server-info\
 servers\
 serverstats\
 server-status\
 service\
 services\
 servicio\
 servicios\
 servlet\
 servlets\
 servlets-examples\
 session\
 sessionmanager\
 setup\
 share\
 shared\
 shell-cgi\
 shipping\
 shop\
 shopper\
 shopping\
 shopscript\
 shr-cgi-bin\
 SilverStream\
 silverstripe\
 simpgb\
 simplebbs\
 simplog\
 site\
 site_sift\
 siteadmin\
 sitebuilder\
 sitebuildercontent\
 sitebuilderfiles\
 sitebuilderpictures\
 sitemgr\
 siteminder\
 siteminderagent\
 sites\
 siteserver\
 sitesift\
 sitestats\
 siteupdate\
 slide\
 sm\
 smartermail\
 smf\
 smreports\
 smreportsviewer\
 snitz\
 snmx-cgi\
 soap\
 soapdocs\
 socialengine\
 socialnetwork\
 software\
 solaris\
 solutions\
 source\
 SpamConsole\
 sphider\
 sphpblog\
 spip\
 spt\
 sql\
 sqlite\
 sqlitemanager\
 sql-ledger\
 squid\
 squirrelcart\
 squirrelmail\
 src\
 srchadm\
 ssi\
 ssl\
 sslkeys\
 staff\
 stat\
 statistic\
 statistics\
 Stats\
 stats_old\
 stats-bin-p\
 status\
 storage\
 store\
 StoreDB\
 storemgr\
 stronghold-info\
 stronghold-status\
 stuff\
 style\
 styles\
 stylesheet\
 stylesheets\
 subir\
 sugar\
 SugarCRM\
 sugarsuite\
 sun\
 super_stats\
 support\
 support/helpdesk\
 support-center\
 supporter\
 supportsuite\
 survey\
 surveys\
 swsbobje\
 sympa\
 symphony\
 sys\
 sysadmin\
 sysbackup\
 sysinfo\
 system\
 tar\
 tarantella\
 tarjetas\
 tdbin\
 te_html\
 teaming\
 tech\
 technote\
 temp\
 template\
 Templates\
 temporal\
 test\
 test-cgi\
 testing\
 testlink\
 tests\
 testsite/typo3\
 testweb\
 themes\
 things\
 thyme\
 ticket\
 tickets\
 tigercrm\
 tiki\
 tinywebgallery\
 tmp\
 ToDo\
 tools\
 toplist\
 topsite\
 topsites\
 tor\
 tpv\
 trabajo\
 trac\
 track\
 tracking\
 transito\
 transpolar\
 tree\
 trees\
 tsweb\
 ttforum\
 turba\
 twg\
 twiki/bin\
 TXWebService\
 typo3\
 typolight\
 ubbthreads\
 uebimiau\
 upb\
 updates\
 upload\
 uploads\
 urchin\
 urchin3\
 urchin5\
 us\
 usage\
 user\
 userdb\
 users\
 usr\
 ustats\
 usuario\
 usuarios\
 util\
 utils\
 v4\
 vcard\
 vcards\
 vfs\
 vhcs2\
 vicidial\
 viewvc\
 viewvc.cgi\
 vtiger\
 w3perl\
 w-agora\
 wavemaster.internal\
 way-board\
 wb\
 wbboard\
 web\
 Web_store\
 web_usage\
 web800fo\
 webaccess\
 webadmin\
 webalizer\
 webapps\
 WebBank\
 webboard\
 WebCalendar\
 webcart\
 webcart-lite\
 webdata\
 WebDB\
 webftp\
 webgallery\
 webimages\
 webimages2\
 webinsta\
 weblog\
 weblogs\
 webmail\
 webmaster\
 webmaster_logs\
 webMathematica\
 webpub\
 webpub-ui\
 webreports\
 webreps\
 webshare\
 WebShop\
 website\
 webstat\
 webstats\
 webthings\
 webtrace\
 WebTrend\
 webtrends\
 Wiki\
 wiki/bin\
 wikka\
 windows\
 word\
 wordpress\
 wordtrans\
 work\
 wsdocs\
 WSsamples\
 wstats\
 wusage\
 wws\
 wwsympa\
 www\
 wwwjoin\
 wwwlog\
 www-sql\
 wwwstat\
 wwwstats\
 x_news\
 x7chat\
 xampp\
 xampp/phpldapadmin\
 xampp/pla\
 xaraya\
 XeroxCentreWareWeb\
 xGB\
 xmb\
 xml\
 xnews\
 x-news\
 xoops\
 XSL\
 xtemp\
 yabb\
 yabb2\
 yabbse\
 yapig\
 yappa\
 yappa-ng\
 zabbix\
 zb41\
 zboard\
 zen\
 zencart\
 zen-cart\
 zenphoto\
 zipfiles\
 zixforum\
 zpanel
 .git
 iishelp
"
FILELIST="\
changelog.txt
readme.txt
README.txt
LICENSE.txt
moodle/README.txt
moodle/lib/upgrade.txt
WEB-INF/web.xml
manual/style/build.properties
manual/style/version.ent
phpinfo.php
info.php
test.php
robots.txt
.htpasswd
.htaccess
localstart.asp
iisstart.asp
iishelp/iis/winhelp/inetmgr.hlp
crossdomain.xml
.git/config"

if [ $# -ne 2 ]; then
        echo -e "\r\\n#### Error ####\r\n\rCommand usage: $CMDNAME ipaddress port" 1>&2
        exit 1
fi

# echo -e "#### Dirctory Scan for http://$1:$2/ ####" > $OUTFILE

for i in $DIRLIST
do
#    echo -n "/$i/ : " >> $OUTFILE
    dirname="$i"
    curl -s -k -I http://$1:$2/$i/ | awk -v dir="${dirname}" 'NR == 1 {print dir " : " $2}' | tee -a $OUTFILE
done

for j in $FILELIST
do
    filename="$j"
    curl -s -k -I http://$1:$2/$j | awk -v file="${filename}" 'NR == 1 {print file " : " $2}' | tee -a $OUTFILE
done
exit

